<!DOCTYPE html>
<html>
<head>
    <title>CP API Header Capture Helper</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .instructions {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        textarea {
            width: 100%;
            height: 200px;
            font-family: 'Courier New', monospace;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 4px;
        }
        button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>üîç CP API Header Capture Helper</h1>
    
    <div class="instructions">
        <h2>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h2>
        <ol>
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ <a href="https://www.cp.pt/pt" target="_blank">https://www.cp.pt/pt</a> –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</li>
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12 –∏–ª–∏ Cmd+Option+I)</li>
            <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É <strong>Network</strong></li>
            <li>–í —Ñ–∏–ª—å—Ç—Ä–µ –≤–≤–µ–¥–∏—Ç–µ: <code>api-gateway</code></li>
            <li>–ù–∞ —Å–∞–π—Ç–µ CP –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Carcavelos ‚Üí Cais do Sodre)</li>
            <li>–í Network tab –Ω–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ <code>api-gateway.cp.pt</code></li>
            <li>–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ –∑–∞–ø—Ä–æ—Å–µ ‚Üí <strong>Copy ‚Üí Copy as cURL</strong></li>
            <li>–í—Å—Ç–∞–≤—å—Ç–µ cURL –∫–æ–º–∞–Ω–¥—É –≤ –ø–æ–ª–µ –Ω–∏–∂–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"</li>
        </ol>
    </div>

    <h2>–í—Å—Ç–∞–≤—å—Ç–µ cURL –∫–æ–º–∞–Ω–¥—É:</h2>
    <textarea id="curlInput" placeholder="curl 'https://api-gateway.cp.pt/...' \&#10;  -H 'authorization: Bearer ...' \&#10;  ..."></textarea>
    <br><br>
    <button onclick="analyzeCurl()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>

    <div id="result" style="display:none;" class="result">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞:</h3>
        <div id="output"></div>
    </div>

    <script>
        function analyzeCurl() {
            const curl = document.getElementById('curlInput').value.trim();
            if (!curl) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—Å—Ç–∞–≤—å—Ç–µ cURL –∫–æ–º–∞–Ω–¥—É');
                return;
            }

            // Parse cURL command
            const urlMatch = curl.match(/curl\s+['"]([^'"]+)['"]/);
            const headers = {};
            const headerMatches = curl.matchAll(/-H\s+['"]([^:]+):\s*([^'"]+)['"]/g);
            
            for (const match of headerMatches) {
                headers[match[1].trim()] = match[2].trim();
            }

            if (!urlMatch) {
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ URL –≤ cURL –∫–æ–º–∞–Ω–¥–µ');
                return;
            }

            const url = urlMatch[1];
            const parsedUrl = new URL(url);
            const path = parsedUrl.pathname + parsedUrl.search;

            // Format output
            let output = '<h4>üìã –ò–∑–≤–ª–µ—á–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>';
            output += '<p><strong>URL:</strong> <code>' + url + '</code></p>';
            output += '<p><strong>Path:</strong> <code>' + path + '</code></p>';
            
            output += '<h4>üîë –ó–∞–≥–æ–ª–æ–≤–∫–∏:</h4>';
            output += '<div class="code-block">';
            for (const [key, value] of Object.entries(headers)) {
                const displayValue = key.toLowerCase().includes('auth') || key.toLowerCase().includes('token') 
                    ? value.substring(0, 50) + '...' 
                    : value;
                output += key + ': ' + displayValue + '<br>';
            }
            output += '</div>';

            // Generate Node.js code
            output += '<h4>üíª –ö–æ–¥ –¥–ª—è server.js:</h4>';
            output += '<div class="code-block">';
            output += 'const endpoint = \'' + path + '\';<br>';
            output += 'const headers = {<br>';
            for (const [key, value] of Object.entries(headers)) {
                output += '    \'' + key + '\': \'' + value + '\',<br>';
            }
            output += '};<br>';
            output += '</div>';

            // Check for authorization
            const hasAuth = Object.keys(headers).some(k => 
                k.toLowerCase().includes('auth') || k.toLowerCase().includes('token')
            );
            
            if (hasAuth) {
                output += '<div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 10px;">';
                output += '‚ö†Ô∏è <strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏!</strong> –≠—Ç–æ –∫–ª—é—á–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.';
                output += '</div>';
            }

            document.getElementById('output').innerHTML = output;
            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>






